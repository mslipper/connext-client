<!-- Generated by documentation.js. Update this documentation by updating the source code. -->

### Table of Contents

-   [Connext][1]
    -   [Parameters][2]
    -   [openChannel][3]
        -   [Parameters][4]
        -   [Examples][5]
    -   [deposit][6]
        -   [Parameters][7]
        -   [Examples][8]
    -   [openThread][9]
        -   [Parameters][10]
        -   [Examples][11]
    -   [joinThread][12]
        -   [Parameters][13]
        -   [Examples][14]
    -   [updateBalances][15]
        -   [Parameters][16]
    -   [closeChannel][17]
        -   [Parameters][18]
        -   [Examples][19]
    -   [closeChannels][20]
        -   [Parameters][21]
        -   [Examples][22]
    -   [withdraw][23]
        -   [Parameters][24]
        -   [Examples][25]
    -   [withdrawFinal][26]
        -   [Parameters][27]
        -   [Examples][28]
    -   [cosignLatestChannelUpdate][29]
        -   [Parameters][30]
        -   [Examples][31]
    -   [cosignChannelUpdate][32]
        -   [Parameters][33]
        -   [Examples][34]
    -   [ChannelOpenTimeoutContractHandler][35]
        -   [Parameters][36]
    -   [getUnjoinedThreads][37]
        -   [Parameters][38]
    -   [getThreadsByChannelId][39]
        -   [Parameters][40]
    -   [getChannelIdByPartyA][41]
        -   [Parameters][42]
    -   [getThreadById][43]
        -   [Parameters][44]
    -   [getThreadByParties][45]
        -   [Parameters][46]
    -   [getChannelById][47]
        -   [Parameters][48]
    -   [getChannelByPartyA][49]
        -   [Parameters][50]
    -   [requestHubDeposit][51]
        -   [Parameters][52]
    -   [getNewChannelId][53]
    -   [createChannelStateUpdateFingerprint][54]
        -   [Parameters][55]
    -   [recoverSignerFromChannelStateUpdate][56]
        -   [Parameters][57]
    -   [createThreadStateUpdateFingerprint][58]
        -   [Parameters][59]
    -   [recoverSignerFromThreadStateUpdate][60]
        -   [Parameters][61]

## Connext

Class representing an instance of a Connext client.

### Parameters

-   `$0` **[Object][62]**
    -   `$0.web3`  
    -   `$0.ingridAddress`   (optional, default `''`)
    -   `$0.watcherUrl`   (optional, default `''`)
    -   `$0.ingridUrl`   (optional, default `''`)
    -   `$0.contractAddress`   (optional, default `''`)
    -   `$0.hubAuth`   (optional, default `''`)
    -   `$0.useAxios`   (optional, default `false`)
-   `web3Lib`   (optional, default `Web3`)
-   `params` **[Object][62]** the constructor object

### openChannel

Opens a channel with the Hub at the address provided when instantiating the Connext instance with the given initial deposit.

Sender defaults to accounts[0] if not supplied to the openChannel function.

Channel challenge timer is determined by the Hub if the parameter is not supplied. Current default value is 3600s (1 hour).

Uses the internal web3 instance to call the createChannel function on the Channel Manager contract, and logs the transaction hash of the channel creation. The function returns the ID of the created channel.

Once the channel is created on chain, users should call the requestJoinChannel function to request that the hub joins the channel. This function should be called on a timeout sufficient for the hub to detect the channel and add it to its database.

If the Hub is unresponsive, or does not join the channel within the challenge period, the client function "ChannelOpenTimeoutContractHandler" can be called by the client to recover the funds.

#### Parameters

-   `initialDeposits` **[Object][62]** deposits in wei (must have at least one deposit)
    -   `initialDeposits.ethDeposit` **BN** deposit in eth (may be null)
    -   `initialDeposits.tokenDeposit` **BN** deposit in tokens (may be null)
-   `tokenAddress`   (optional, default `null`)
-   `sender` **[String][63]** (optional) counterparty with hub in channel, defaults to accounts[0] (optional, default `null`)
-   `challenge` **[Number][64]** (optional) challenge period in seconds (optional, default `null`)

#### Examples

```javascript
const deposit = Web3.utils.toBN(Web3.utils.toWei('1', 'ether))
const lcId = await connext.openChannel(deposit)
```

Returns **[Promise][65]** resolves to the channel id of the created channel

### deposit

Adds a deposit to an existing channel by calling the contract function "deposit" using the internal web3 instance.

Can be used by any either channel party.

If sender is not supplied, it defaults to accounts[0]. If the recipient is not supplied, it defaults to the sender.

#### Parameters

-   `deposits` **[Object][62]** deposit object
    -   `deposits.ethDeposit` **BN** value of the channel deposit in ETH
    -   `deposits.tokenDeposit` **BN** value of the channel deposit in tokens
-   `sender` **[String][63]** (optional) ETH address sending funds to the channel (optional, default `null`)
-   `recipient` **[String][63]** (optional) ETH address recieving funds in their channel (optional, default `sender`)
-   `tokenAddress` **[String][63]** (optional, for testing) contract address of channel tokens (optional, default `null`)

#### Examples

```javascript
// get a BN
const deposit = Web3.utils.toBN(Web3.utils.toWei('1','ether'))
const txHash = await connext.deposit(deposit)
```

Returns **[Promise][65]** resolves to the transaction hash of the onchain deposit.

### openThread

Opens a thread between "to" and sender with via the hub. Both users must have a channel open with the hub.

If there is no deposit provided, then 100% of the channel balance is added to thread deposit. This function is to be called by the "A" party in a unidirectional scheme.

Signs a copy of the initial thread state, and generates a proposed channel update to the hub for countersigning that updates the number of open threads and the root hash of the channel state.

This proposed state update serves as the opening certificate for the thread, and is used to verify that the hub agreed to facilitate the creation of the thread and take on the counterparty risk.

#### Parameters

-   `params` **[Object][62]** the method object
    -   `params.to` **[String][63]** ETH address you want to open a thread with
    -   `params.deposit` **BN** (optional) deposit in wei for the thread, defaults to the entire LC balance (optional, default `null`)
    -   `params.sender` **[String][63]** (optional) who is initiating the thread creation, defaults to accounts[0] (optional, default `null`)

#### Examples

```javascript
const myFriendsAddress = "0x627306090abaB3A6e1400e9345bC60c78a8BEf57"
await connext.openThread({ to: myFriendsAddress })
```

Returns **[Promise][65]** resolves to the thread ID recieved by Ingrid

### joinThread

Joins thread with provided channelId with a deposit of 0 (unidirectional channels).

This function is to be called by the "B" party in a unidirectional scheme.

#### Parameters

-   `threadId`  
-   `sender` **[String][63]** (optional) ETH address of the person joining the thread (partyB) (optional, default `null`)
-   `channelId` **[String][63]** ID of the thread

#### Examples

```javascript
const channelId = 10 // pushed to partyB from the hub
await connext.joinThread(channelId)
```

Returns **[Promise][65]** resolves to the thread ID

### updateBalances

Send multiple balance updates simultaneously from a single account.

#### Parameters

-   `payments` **[Array][66]&lt;[Object][62]>** payments object
-   `sender` **[String][63]** (optional) defaults to accounts[0] (optional, default `null`)

### closeChannel

Closes a thread.

Retrieves the latest virtual state update, and decomposes the thread into their respective channel updates.

The thread agent who called this function signs the closing channel update, and forwards the signature to the hub.

The hub verifies the signature, returns its signature of the proposed thread decomposition, and proposes the channel update for the other thread participant.

If the hub does not return its signature on the proposed thread decomposition, the caller goes to chain by calling initThread and settleThread.

#### Parameters

-   `threadId`  
-   `sender`   (optional, default `null`)
-   `channelId` **[Number][64]** ID of the thread to close

#### Examples

```javascript
await connext.closeChannel({
  channelId: 0xadsf11..,
  balance: web3.utils.toBN(web3.utils.toWei(0.5, 'ether'))
})
```

Returns **[Promise][65]** resolves to the signature of the hub on the generated update if accepted, or the result of closing the channel on chain if there is a dispute

### closeChannels

Closes many threads by calling closeChannel on each channel ID in the provided array.

#### Parameters

-   `channelIds` **[Array][66]&lt;[String][63]>** array of thread IDs you wish to close
-   `sender`   (optional, default `null`)

#### Examples

```javascript
const channels = [
    0xasd310..,
    0xadsf11..,
]
await connext.closeChannels(channels)
```

### withdraw

Withdraws bonded funds from an existing channel.

All threads must be closed before a channel can be closed.

Generates the state update from the latest hub signed state with fast-close flag.

The Hub should countersign the closing update if it matches what she has signed previously, and the channel will fast close by calling consensusCloseChannel on the contract.

If the state update doesn't match what the hub previously signed, then updateChannelState is called with the latest state and a challenge flag.

#### Parameters

-   `sender`   (optional, default `null`)
-   `null-null` **[String][63]** (optional) who the transactions should be sent from, defaults to account[0]

#### Examples

```javascript
const success = await connext.withdraw()
```

Returns **[Promise][65]** resolves to an object with the structure: { response: transactionHash, fastClosed: true}

### withdrawFinal

Withdraw bonded funds from channel after a channel is challenge-closed and the challenge period expires by calling withdrawFinal using the internal web3 instance.

Looks up Channel by the account address of the client-side user if sender parameter is not supplied.

Calls the "byzantineCloseChannel" function on the contract.

#### Parameters

-   `sender` **[String][63]** (optional) the person sending the on chain transaction, defaults to accounts[0] (optional, default `null`)

#### Examples

```javascript
const success = await connext.withdraw()
if (!success) {
  // wait out challenge timer
  await connext.withdrawFinal()
}
```

Returns **[Promise][65]** resolves to the transaction hash from calling byzantineCloseChannel

### cosignLatestChannelUpdate

Verifies and cosigns the latest ledger state update.

#### Parameters

-   `channelId`  
-   `sender` **[String][63]** (optional) the person who cosigning the update, defaults to accounts[0] (optional, default `null`)
-   `lcId` **[String][63]** channel id

#### Examples

```javascript
const lcId = await connext.getChannelIdByPartyA() // get ID by accounts[0] and open status by default
await connext.cosignLatestChannelUpdate(channelId)
```

Returns **[Promise][65]** resolves to the cosigned channel state update

### cosignChannelUpdate

Verifies and cosigns the ledger state update indicated by the provided nonce.

#### Parameters

-   `params` **[Object][62]** the method object
    -   `params.sender` **[String][63]** (optional) the person who cosigning the update, defaults to accounts[0] (optional, default `null`)
    -   `params.lcId` **[String][63]** channel id
    -   `params.channelId`  
    -   `params.nonce`  

#### Examples

```javascript
const lcId = await connext.getChannelIdByPartyA() // get ID by accounts[0] and open status by default
await connext.cosignLatestChannelUpdate(lcId)
```

Returns **[Promise][65]** resolves to the cosigned channel state update

### ChannelOpenTimeoutContractHandler

Watchers or users should call this to recover bonded funds if the hub fails to join the channel within the challenge window.

#### Parameters

-   `channelId`  
-   `sender` **[String][63]** (optional) who is calling the transaction (defaults to accounts[0]) (optional, default `null`)
-   `lcId` **[String][63]** channel id the hub did not join

Returns **[Promise][65]** resolves to the result of sending the transaction

### getUnjoinedThreads

Requests the unjoined threads that have been initiated with you. All threads are unidirectional, and only the reciever of payments may have unjoined threads.

#### Parameters

-   `partyB` **[String][63]** (optional) ETH address of party who has yet to join thread threads. (optional, default `null`)

Returns **[Promise][65]** resolves to an array of unjoined thread objects

### getThreadsByChannelId

Returns an array of the thread states associated with the given channel.

#### Parameters

-   `channelId` **[String][63]** ID of the channel

Returns **[Promise][65]** resolves to an Array of thread objects

### getChannelIdByPartyA

Returns the channel id between the supplied address and hub.

If no address is supplied, accounts[0] is used as partyA.

#### Parameters

-   `partyA` **[String][63]** (optional) address of the partyA in the channel with the hub. (optional, default `null`)
-   `status` **[Number][64]** (optional) state of thread, can be 0 (opening), 1 (opened), 2 (settling), or 3 (settled). Defaults to open channel. (optional, default `null`)

Returns **[Promise][65]** resolves to either the channel id between hub and supplied partyA, or an Array of the channel IDs between hub and partyA.

### getThreadById

Returns an object representing the thread in the database.

#### Parameters

-   `threadId` **[String][63]** the ID of the thread

Returns **[Promise][65]** resolves to an object representing the thread

### getThreadByParties

Returns an object representing the open thread between the two parties in the database.

#### Parameters

-   `params` **[Object][62]** the method object
    -   `params.partyA` **[String][63]** ETH address of partyA in thread
    -   `params.partyB` **[String][63]** ETH address of partyB in thread

Returns **[Promise][65]** resolves to the thread

### getChannelById

Returns an object representing a channel.

#### Parameters

-   `channelId`  
-   `lcId` **[String][63]** the channel id

Returns **[Promise][65]** resolves to the channel object

### getChannelByPartyA

Returns object representing the channel between partyA and the hub

#### Parameters

-   `partyA` **[String][63]** (optional) partyA in channel. Default is accounts[0] (optional, default `null`)
-   `status` **[Number][64]** (optional) state of thread, can be 0 (opening), 1 (opened), 2 (settling), or 3 (settled). Defaults to open channel. (optional, default `null`)

Returns **[Promise][65]** resolves to channel object

### requestHubDeposit

Requests hub deposits into a given subchannel. Hub must have sufficient balance in the "B" subchannel to cover the thread balance of "A" since the Hub is assuming the financial counterparty risk.

This function is to be used if the hub has insufficient balance in the channel to create proposed threads.

#### Parameters

-   `params` **[Object][62]** the method object
    -   `params.channelId` **[String][63]** id of the channel
    -   `params.deposit` **BN** the deposit in Wei

Returns **[Promise][65]** resolves to the transaction hash of hub calling the deposit function

### getNewChannelId

Returns a new channel id that is a random hex string.

Returns **[String][63]** a random 32 byte channel ID.

### createChannelStateUpdateFingerprint

Hashes the channel state update information using soliditySha3.

#### Parameters

-   `params` **[Object][62]** the method object
    -   `params.isClose` **[Boolean][67]** flag indicating whether or not this is closing state
    -   `params.nonce` **[Number][64]** the sequence of the channel update
    -   `params.openVcs` **[Number][64]** the number of open threads associated with this channel
    -   `params.vcRootHash` **[String][63]** the root hash of the Merkle tree containing all initial states of the open threads
    -   `params.partyA` **[String][63]** ETH address of partyA in the ledgerchannel
    -   `params.partyI` **[String][63]** ETH address of the hub
    -   `params.balanceA` **[Number][64]** updated balance of partyA
    -   `params.balanceI` **[Number][64]** updated balance of partyI
    -   `params.channelId`  
    -   `params.ethBalanceA`  
    -   `params.ethBalanceI`  
    -   `params.tokenBalanceA`  
    -   `params.tokenBalanceI`  

Returns **[String][63]** the hash of the state data

### recoverSignerFromChannelStateUpdate

Recovers the signer from the hashed data generated by the Connext.createChannelStateUpdateFingerprint function.

#### Parameters

-   `params` **[Object][62]** the method object
    -   `params.channelId` **[String][63]** ID of the channel you are creating a state update for
    -   `params.sig` **[String][63]** the signature of the data from an unknown agent
    -   `params.isClose` **[Boolean][67]** flag indicating whether or not this is closing state
    -   `params.nonce` **[Number][64]** the sequence of the channel update
    -   `params.openVcs` **[Number][64]** the number of open threads associated with this channel
    -   `params.vcRootHash` **[String][63]** the root hash of the Merkle tree containing all initial states of the open threads
    -   `params.partyA` **[String][63]** ETH address of partyA in the channel
    -   `params.partyI` **[String][63]** ETH address of the hub
    -   `params.balanceA` **[Number][64]** updated balance of partyA
    -   `params.balanceI` **[Number][64]** updated balance of partyI
    -   `params.ethBalanceA`  
    -   `params.ethBalanceI`  
    -   `params.tokenBalanceA`  
    -   `params.tokenBalanceI`  

Returns **[String][63]** the ETH address of the person who signed the data

### createThreadStateUpdateFingerprint

Hashes data from a thread state update using soliditySha3.

#### Parameters

-   `params` **[Object][62]** the method object
    -   `params.channelId` **[String][63]** ID of the thread you are creating a state update for
    -   `params.nonce` **[Number][64]** the sequence of the state update
    -   `params.partyA` **[String][63]** ETH address of partyA
    -   `params.partyB` **[String][63]** ETH address of partyB
    -   `params.balanceA` **[Number][64]** updated balance of partyA
    -   `params.balanceB` **[Number][64]** updated balance of partyB
    -   `params.ethBalanceA`  
    -   `params.ethBalanceB`  
    -   `params.tokenBalanceA`  
    -   `params.tokenBalanceB`  

Returns **[String][63]** hash of the thread state data

### recoverSignerFromThreadStateUpdate

Recovers the signer from the hashed data generated by the Connext.createThreadStateUpdateFingerprint function.

#### Parameters

-   `params` **[Object][62]** the method object
    -   `params.sig` **[String][63]** signature of the data created in Connext.createThreadStateUpdate
    -   `params.channelId` **[String][63]** ID of the thread you are creating a state update for
    -   `params.nonce` **[Number][64]** the sequence of the state update
    -   `params.partyA` **[String][63]** ETH address of partyA
    -   `params.partyB` **[String][63]** ETH address of partyB
    -   `params.balanceA` **[Number][64]** updated balance of partyA
    -   `params.balanceB` **[Number][64]** updated balance of partyB
    -   `params.ethBalanceA`  
    -   `params.ethBalanceB`  
    -   `params.tokenBalanceA`  
    -   `params.tokenBalanceB`  

Returns **[String][63]** ETH address of the person who signed the data

[1]: #connext

[2]: #parameters

[3]: #openchannel

[4]: #parameters-1

[5]: #examples

[6]: #deposit

[7]: #parameters-2

[8]: #examples-1

[9]: #openthread

[10]: #parameters-3

[11]: #examples-2

[12]: #jointhread

[13]: #parameters-4

[14]: #examples-3

[15]: #updatebalances

[16]: #parameters-5

[17]: #closechannel

[18]: #parameters-6

[19]: #examples-4

[20]: #closechannels

[21]: #parameters-7

[22]: #examples-5

[23]: #withdraw

[24]: #parameters-8

[25]: #examples-6

[26]: #withdrawfinal

[27]: #parameters-9

[28]: #examples-7

[29]: #cosignlatestchannelupdate

[30]: #parameters-10

[31]: #examples-8

[32]: #cosignchannelupdate

[33]: #parameters-11

[34]: #examples-9

[35]: #channelopentimeoutcontracthandler

[36]: #parameters-12

[37]: #getunjoinedthreads

[38]: #parameters-13

[39]: #getthreadsbychannelid

[40]: #parameters-14

[41]: #getchannelidbypartya

[42]: #parameters-15

[43]: #getthreadbyid

[44]: #parameters-16

[45]: #getthreadbyparties

[46]: #parameters-17

[47]: #getchannelbyid

[48]: #parameters-18

[49]: #getchannelbypartya

[50]: #parameters-19

[51]: #requesthubdeposit

[52]: #parameters-20

[53]: #getnewchannelid

[54]: #createchannelstateupdatefingerprint

[55]: #parameters-21

[56]: #recoversignerfromchannelstateupdate

[57]: #parameters-22

[58]: #createthreadstateupdatefingerprint

[59]: #parameters-23

[60]: #recoversignerfromthreadstateupdate

[61]: #parameters-24

[62]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object

[63]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String

[64]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number

[65]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Promise

[66]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array

[67]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Boolean
